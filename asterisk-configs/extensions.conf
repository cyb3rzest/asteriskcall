;===============================================================================
; Extensions Configuration for Asterisk Call Management System
;===============================================================================

[general]
static=yes
writeprotect=no
clearglobalvars=no

;===============================================================================
; Outbound Calls Context - For 10-digit phone numbers
;===============================================================================
[outbound-calls]
; Handle outbound calls from web interface
exten => _XXXXXXXXXX,1,NoOp(Outbound call from ${SELF_NUMBER} to ${EXTEN})
exten => _XXXXXXXXXX,n,Set(CALLERID(num)=${SELF_NUMBER})
exten => _XXXXXXXXXX,n,Set(CALLERID(name)=${SELF_NUMBER})
exten => _XXXXXXXXXX,n,Answer()
exten => _XXXXXXXXXX,n,Wait(1)
exten => _XXXXXXXXXX,n,Playback(beep)
; Dial through Tbitel trunk using PJSIP
exten => _XXXXXXXXXX,n,Dial(PJSIP/${EXTEN}@tbitel,60,tT)
exten => _XXXXXXXXXX,n,Hangup()

; For testing with local extensions (remove in production)
exten => _60XX,1,NoOp(Test call to local extension ${EXTEN})
exten => _60XX,n,Set(CALLERID(num)=${SELF_NUMBER})
exten => _60XX,n,Answer()
exten => _60XX,n,Wait(1)
exten => _60XX,n,Dial(PJSIP/${EXTEN},30,tT)
exten => _60XX,n,Hangup()

;===============================================================================
; Default Context - Internal Extensions
;===============================================================================
[default]
; Internal extension dialing
exten => _60XX,1,NoOp(Calling internal extension ${EXTEN})
exten => _60XX,n,Dial(PJSIP/${EXTEN},30,tT)
exten => _60XX,n,Hangup()

; External number dialing
exten => _X.,1,NoOp(Calling external number ${EXTEN})
exten => _X.,n,Dial(PJSIP/${EXTEN}@tbitel,30,tT)
exten => _X.,n,Hangup()

; Hold extension
exten => hold,1,NoOp(Call placed on hold)
exten => hold,n,MusicOnHold()
exten => hold,n,Hangup()

; Recording test extension
exten => 999,1,NoOp(Recording test)
exten => 999,n,Answer()
exten => 999,n,Playback(hello-world)
exten => 999,n,Record(/tmp/test-recording.wav,10,k)
exten => 999,n,Playback(/tmp/test-recording)
exten => 999,n,Hangup()

;===============================================================================
; From Trunk Context - Incoming Calls
;===============================================================================
[from-trunk]
; Route incoming calls to extension 6001
exten => _X.,1,NoOp(Incoming call from ${CALLERID(num)})
exten => _X.,n,Dial(PJSIP/6001,30,tT)
exten => _X.,n,Hangup()

;===============================================================================
; Voicemail Context
;===============================================================================
[voicemail]
exten => _X.,1,NoOp(Voicemail for ${EXTEN})
exten => _X.,n,VoiceMail(${EXTEN}@default)
exten => _X.,n,Hangup()

;===============================================================================
; Conference Context
;===============================================================================
[conference]
exten => 8000,1,NoOp(Conference room)
exten => 8000,n,ConfBridge(conference1)
exten => 8000,n,Hangup()